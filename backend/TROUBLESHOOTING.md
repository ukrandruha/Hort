# Troubleshooting 502 Bad Gateway

## Можливі причини та рішення

### 1. Prisma Client не згенерований
**Проблема**: Після оновлення коду Prisma Client може бути не згенерований.

**Рішення**:
```bash
cd backend
npm run prisma:generate
```

### 2. Відсутні env змінні
**Проблема**: Сервер не може запуститися без обов'язкових змінних.

**Перевірте наявність**:
- `JWT_SECRET` - обов'язкова
- `DATABASE_URL` - обов'язкова
- `CORS_ORIGIN` - опціональна (має fallback)
- `PORT` - опціональна (має fallback 3001)
- `HOST` - опціональна (має fallback 0.0.0.0)

### 3. Помилка підключення до бази даних
**Проблема**: Prisma не може підключитися до PostgreSQL.

**Перевірте**:
- Чи правильний `DATABASE_URL`
- Чи доступна база даних
- Чи є мережевий доступ до БД

### 4. Помилка компіляції TypeScript
**Проблема**: Код не скомпільований або є помилки компіляції.

**Рішення**:
```bash
cd backend
npm run build
```

### 5. Помилка з новими імпортами
**Проблема**: Нові файли (`db/prisma.ts`, `utils/errors.ts`, `utils/validation.ts`) не скомпільовані.

**Рішення**:
- Переконайтеся, що всі файли скомпільовані
- Перевірте, чи всі залежності встановлені: `npm install`

## Швидка перевірка

1. **Перевірте логи сервера** - там має бути конкретна помилка
2. **Перевірте, чи запущений процес**: `ps aux | grep node`
3. **Перевірте порт**: `netstat -tulpn | grep 3001`
4. **Перевірте env змінні на сервері**

## Кроки для виправлення

1. Зупиніть сервер
2. Оновіть код
3. Встановіть залежності: `npm install`
4. Згенеруйте Prisma Client: `npm run prisma:generate`
5. Скомпілюйте TypeScript: `npm run build`
6. Перевірте env змінні
7. Запустіть сервер: `npm start`

## Перевірка помилок

Якщо сервер падає при старті, перевірте:
- Логи процесу
- Логи systemd (якщо використовується)
- Логи PM2 (якщо використовується)
- Консольний вивід при запуску

## Додаткова інформація

Якщо проблема залишається:
1. Спробуйте запустити локально: `npm run dev`
2. Перевірте, чи працює без нових змін
3. Поступово додавайте зміни та перевіряйте
